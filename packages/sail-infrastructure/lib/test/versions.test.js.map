{"version":3,"file":"versions.test.js","sourceRoot":"","sources":["../../src/test/versions.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation and contributors. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { strict as assert } from \"node:assert\";\nimport * as path from \"node:path\";\n\nimport { expect } from \"chai\";\nimport { afterEach, describe, it } from \"mocha\";\nimport * as semver from \"semver\";\nimport { simpleGit } from \"simple-git\";\n\nimport { loadBuildProject } from \"../buildProject.js\";\nimport type { ReleaseGroupName, WorkspaceName } from \"../types.js\";\nimport { setVersion } from \"../versions.js\";\n\nimport { testDataPath, testRepoRoot } from \"./init.js\";\n\nconst repo = loadBuildProject(path.join(testDataPath, \"./testRepo\"));\nconst main = repo.releaseGroups.get(\"main\" as ReleaseGroupName);\nassert(main !== undefined);\n\nconst group2 = repo.releaseGroups.get(\"group2\" as ReleaseGroupName);\nassert(group2 !== undefined);\n\nconst group3 = repo.releaseGroups.get(\"group3\" as ReleaseGroupName);\nassert(group3 !== undefined);\n\nconst secondWorkspace = repo.workspaces.get(\"second\" as WorkspaceName);\nassert(secondWorkspace !== undefined);\n\n/**\n * A git client rooted in the test repo. Used for resetting tests.\n */\nconst git = simpleGit(testRepoRoot);\n\ndescribe(\"setVersion\", () => {\n\tafterEach(async () => {\n\t\tawait git.checkout([\"HEAD\", \"--\", testRepoRoot]);\n\t\trepo.reload();\n\t});\n\n\tit(\"release group\", async () => {\n\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\tawait setVersion(main.packages, semver.parse(\"1.2.1\")!);\n\n\t\tconst allCorrect = main.packages.every((pkg) => pkg.version === \"1.2.1\");\n\t\texpect(main.version).to.equal(\"1.2.1\");\n\t\texpect(allCorrect).to.be.true;\n\t});\n\n\tit(\"workspace\", async () => {\n\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\tawait setVersion(secondWorkspace.packages, semver.parse(\"2.2.1\")!);\n\n\t\tconst allCorrect = secondWorkspace.packages.every((pkg) => pkg.version === \"2.2.1\");\n\t\texpect(allCorrect).to.be.true;\n\t});\n\n\tit(\"repo\", async () => {\n\t\tconst packages = [...repo.packages.values()];\n\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\tawait setVersion(packages, semver.parse(\"1.2.1\")!);\n\n\t\tconst allCorrect = packages.every((pkg) => pkg.version === \"1.2.1\");\n\t\texpect(allCorrect).to.be.true;\n\t});\n});\n"]}